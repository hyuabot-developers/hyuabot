"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5950],{5950:(W,d,r)=>{r.r(d),r.d(d,{BusModule:()=>G});var a=r(5056),m=r(6895),C=r(4006),N=r(581),_=r(7885),c=r(4964),e=r(6353),h=r(8904),T=r(4471),l=r(6753),p=r(9632);const f=function(t,o,n){return{minute:t,stop:o,seat:n}};function Z(t,o){if(1&t&&(e.TgZ(0,"ion-text",11),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const n=e.oxw().$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,"bus.realtime.item.withSeat",e.kEZ(4,f,n.remainedTime,n.remainedStop,n.remainedSeat)))}}const b=function(t,o){return{minute:t,stop:o}};function I(t,o){if(1&t&&(e.TgZ(0,"ion-text",11),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const n=e.oxw().$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,"bus.realtime.item.withoutSeat",e.WLB(4,b,n.remainedTime,n.remainedStop)))}}function w(t,o){if(1&t&&(e.TgZ(0,"ion-text",12),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const n=e.oxw().$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,"bus.realtime.item.withSeat",e.kEZ(4,f,n.remainedTime,n.remainedStop,n.remainedSeat)))}}function B(t,o){if(1&t&&(e.TgZ(0,"ion-text",12),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const n=e.oxw().$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,"bus.realtime.item.withoutSeat",e.WLB(4,b,n.remainedTime,n.remainedStop)))}}function S(t,o){if(1&t&&(e.TgZ(0,"ion-item",7)(1,"div",8),e.YNc(2,Z,3,8,"ion-text",9),e.YNc(3,I,3,7,"ion-text",9),e.YNc(4,w,3,8,"ion-text",10),e.YNc(5,B,3,7,"ion-text",10),e.qZA()()),2&t){const n=o.$implicit,i=o.index,s=e.oxw(2);e.xp6(2),e.Q6J("ngIf",n.remainedSeat>=0&&i!==s.routeItem.realtime.length+s.routeItem.timetable.length-1),e.xp6(1),e.Q6J("ngIf",n.remainedSeat<0&&i!==s.routeItem.realtime.length+s.routeItem.timetable.length-1),e.xp6(1),e.Q6J("ngIf",n.remainedSeat>=0&&i===s.routeItem.realtime.length+s.routeItem.timetable.length-1),e.xp6(1),e.Q6J("ngIf",n.remainedSeat<0&&i===s.routeItem.realtime.length+s.routeItem.timetable.length-1)}}function O(t,o){if(1&t&&e.YNc(0,S,6,4,"ion-item",6),2&t){const n=e.oxw();e.Q6J("ngForOf",n.routeItem.realtime.slice(0,6))}}const x=function(t,o){return{hour:t,minute:o}};function k(t,o){if(1&t&&(e.TgZ(0,"ion-text"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const n=e.oxw().$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,"bus.timetable.item",e.WLB(4,x,n.departureTime.split(":")[0],n.departureTime.split(":")[1])))}}function P(t,o){if(1&t&&(e.TgZ(0,"ion-text",15),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t){const n=e.oxw().$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,"bus.timetable.last.item",e.WLB(4,x,n.departureTime.split(":")[0],n.departureTime.split(":")[1])))}}function v(t,o){if(1&t&&(e.TgZ(0,"ion-item",7)(1,"div",8),e.YNc(2,k,3,7,"ion-text",13),e.YNc(3,P,3,7,"ion-text",14),e.qZA()()),2&t){const n=o.index,i=e.oxw(2);e.xp6(2),e.Q6J("ngIf",n!==i.routeItem.timetable.length-1),e.xp6(1),e.Q6J("ngIf",n===i.routeItem.timetable.length-1)}}function y(t,o){if(1&t&&e.YNc(0,v,4,2,"ion-item",6),2&t){const n=e.oxw();e.Q6J("ngForOf",n.routeItem.timetable.slice(0,7-n.routeItem.realtime.length))}}function A(t,o){1&t&&(e.TgZ(0,"ion-item",7)(1,"ion-label",16),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&t&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"shuttle.out_of_service")))}function M(t,o){1&t&&e._UZ(0,"ion-icon",17)}function q(t,o){1&t&&e._UZ(0,"ion-icon",18)}const Y=function(t){return{routeName:t}};let J=(()=>{class t{constructor(n){this.busService=n,this.now=new Date}ngOnInit(){this.timetableURL="/bus/timetable?route="+this.routeName+"&stop="+this.stopName,this.busService.busArrivalList.subscribe(n=>{this.routeItem=n.find(i=>i.routeName===this.routeName&&i.stopName===this.getStopName()),this.routeItem=void 0===n.find(i=>i.routeName===this.routeName&&i.stopName===this.getStopName())?{stopName:this.getStopName(),routeName:this.routeName,realtime:[],timetable:[]}:n.find(i=>i.routeName===this.routeName&&i.stopName===this.getStopName())})}getStopName(){switch(this.stopName){case"guestHouse":return"\ud55c\uc591\ub300\uac8c\uc2a4\ud2b8\ud558\uc6b0\uc2a4";case"mainGate":return"\ud55c\uc591\ub300\uc815\ubb38"}}isBookmarked(){return localStorage.getItem("bookmark.bus.index")===this.swipeIndex}addBookmark(){localStorage.setItem("bookmark.bus.index",this.swipeIndex)}removeBookmark(){localStorage.removeItem("bookmark.bus.index")}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(h.Z))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-bus-card"]],inputs:{routeName:"routeName",routeColor:"routeColor",stopName:"stopName",destination:"destination",swipeIndex:"swipeIndex"},decls:23,vars:22,consts:[[3,"className"],[3,"href"],[3,"ngIf"],["fill","clear",3,"click"],["slot","icon-only","name","bookmark-outline",4,"ngIf"],["slot","icon-only","name","bookmark","color","primary",4,"ngIf"],["lines","none",4,"ngFor","ngForOf"],["lines","none"],[1,"container"],["class","realtime",4,"ngIf"],["class","realtime last-bus",4,"ngIf"],[1,"realtime"],[1,"realtime","last-bus"],[4,"ngIf"],["class","last-bus",4,"ngIf"],[1,"last-bus"],[2,"text-align","center"],["slot","icon-only","name","bookmark-outline"],["slot","icon-only","name","bookmark","color","primary"]],template:function(n,i){1&n&&(e.TgZ(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title",0),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"ion-card-subtitle"),e._uU(6),e.ALo(7,"translate"),e.qZA()(),e.TgZ(8,"ion-card-content")(9,"ion-list")(10,"ion-list-header")(11,"ion-label"),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"ion-button",1),e._uU(15),e.ALo(16,"translate"),e.qZA()(),e.YNc(17,O,1,1,"ng-template",2),e.YNc(18,y,1,1,"ng-template",2),e.YNc(19,A,4,3,"ng-template",2),e.qZA()(),e.TgZ(20,"ion-button",3),e.NdJ("click",function(){return i.isBookmarked()?i.removeBookmark():i.addBookmark()}),e.YNc(21,M,1,0,"ion-icon",4),e.YNc(22,q,1,0,"ion-icon",5),e.qZA()()),2&n&&(e.xp6(2),e.Q6J("className",i.routeColor),e.xp6(1),e.Oqu(e.xi3(4,11,"bus.routeName",e.VKq(20,Y,i.routeName))),e.xp6(3),e.Oqu(e.lcZ(7,14,"bus.stop."+i.stopName)),e.xp6(6),e.Oqu(e.lcZ(13,16,"bus.heading."+i.destination)),e.xp6(2),e.Q6J("href",i.timetableURL),e.xp6(1),e.Oqu(e.lcZ(16,18,"bus.timetable.all")),e.xp6(2),e.Q6J("ngIf",i.routeItem.realtime.length>0),e.xp6(1),e.Q6J("ngIf",i.routeItem.timetable.length>0),e.xp6(1),e.Q6J("ngIf",i.routeItem.realtime.length+i.routeItem.timetable.length===0),e.xp6(2),e.Q6J("ngIf",!i.isBookmarked()),e.xp6(1),e.Q6J("ngIf",i.isBookmarked()))},dependencies:[a.YG,a.PM,a.FN,a.Zi,a.tO,a.Dq,a.gu,a.Ie,a.Q$,a.q_,a.yh,a.yW,m.sg,m.O5,l.X$],styles:["ion-card[_ngcontent-%COMP%]{margin-left:4px;margin-right:4px}ion-list-header[_ngcontent-%COMP%]{padding-left:0}ion-list-header[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{text-align:start;font-size:large;margin-top:5px}ion-list-header[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin-top:5px;--padding-start: 0;--padding-end: 0}ion-list-header[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:medium}ion-item[_ngcontent-%COMP%]{--padding-start: 0;--padding-end: 0;--inner-padding-end: 0;--min-height: 16px}ion-item[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:flex-end;flex-direction:row}ion-item[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .realtime[_ngcontent-%COMP%]{font-weight:700}ion-item[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{font-size:medium;text-align:end;margin-top:5px;margin-bottom:5px}.DH[_ngcontent-%COMP%]{color:red;font-weight:700}.DY[_ngcontent-%COMP%]{color:green;font-weight:700}.C[_ngcontent-%COMP%]{color:#00f;font-weight:700}.last-bus[_ngcontent-%COMP%]{color:red;font-weight:700}"]}),t})();function Q(t,o){1&t&&(e.TgZ(0,"div",7),e._UZ(1,"app-bus-card",8),e.qZA())}function U(t,o){1&t&&(e.TgZ(0,"div",7),e._UZ(1,"app-bus-card",9),e.qZA())}function $(t,o){1&t&&(e.TgZ(0,"div",7),e._UZ(1,"app-bus-card",10),e.qZA())}const L=c.Ps`
  query GetPeriod($currentDate: String!) {
    shuttle {
      weekday (date: $currentDate),
    }
  }
`,D=c.Ps`
  query GetBus($weekday: String!, $startTime: String!) {
    bus(routePair: [
      {stopName: "한양대게스트하우스", routeName: "10-1"},
      {stopName: "한양대게스트하우스", routeName: "3102"},
      {stopName: "한양대정문", routeName: "707-1"},
    ]) {
      stopName, routeName,
      realtime {remainedStop, remainedTime, remainedSeat},
      timetable (weekday: $weekday, startTime: $startTime) {
        departureTime
      }
    }
  }
`,F=[{path:"",component:(()=>{class t{constructor(n,i,s,u,g){this.apollo=n,this.busService=i,this.toastController=s,this.loadingService=u,this.translateService=g,this.weekday="weekdays"}ngOnInit(){const n=new Date;this.busDateSubscription=this.apollo.watchQuery({query:L,variables:{currentDate:`${n.getFullYear()}-${n.getMonth()+1}-${n.getDate()}`}}).valueChanges.subscribe(({data:i})=>{this.weekday=i.shuttle.weekday,this.busDateSubscription?.unsubscribe(),this.busQuery=this.apollo.watchQuery({query:D,pollInterval:6e4,variables:{weekday:this.weekday,startTime:`${n.getHours()}:${n.getMinutes()}`}}),this.busTimetableSubscription=this.busQuery.valueChanges.subscribe(({data:u,loading:g})=>{this.busService.setLoading(g),this.busService.setBusArrivalList(u.bus)})}),this.busService.loading.subscribe(i=>{i&&this.loadingService.present("bus.loading","bus.loading").then(()=>{this.busService.loading.subscribe(s=>{s||this.loadingService.dismiss("bus.loading").then()})})})}ngOnDestroy(){this.busDateSubscription?.unsubscribe(),this.busTimetableSubscription?.unsubscribe()}refreshBusTimetable(n){this.busQuery.refetch().then(()=>{n.target.complete()})}setSwiperInstance(n){this.swiper=n,localStorage.getItem("bookmark.bus.index")&&this.swiper.slideTo(parseInt(localStorage.getItem("bookmark.bus.index")||"0",10))}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(c._M),e.Y36(h.Z),e.Y36(a.yF),e.Y36(T.b),e.Y36(l.sK))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-bus"]],decls:17,vars:8,consts:[[3,"translucent"],[3,"fullscreen"],["collapse","condense"],["size","large"],["slot","fixed",3,"ionRefresh"],["slidesPerView","1.2","centeredSlides","centeredSlides",3,"swiper"],["swiperSlide",""],[1,"slide-content"],["swipeIndex","0","routeName","10-1","routeColor","green","stopName","guestHouse","destination","sangnoksu"],["swipeIndex","1","routeName","707-1","routeColor","red","stopName","mainGate","destination","suwon"],["swipeIndex","2","routeName","3102","routeColor","red","stopName","guestHouse","destination","gangnam"]],template:function(n,i){1&n&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e._uU(3),e.ALo(4,"translate"),e.qZA()()(),e.TgZ(5,"ion-content",1)(6,"ion-header",2)(7,"ion-toolbar")(8,"ion-title",3),e._uU(9),e.ALo(10,"translate"),e.qZA()()(),e.TgZ(11,"ion-refresher",4),e.NdJ("ionRefresh",function(u){return i.refreshBusTimetable(u)}),e._UZ(12,"ion-refresher-content"),e.qZA(),e.TgZ(13,"swiper",5),e.NdJ("swiper",function(u){return i.setSwiperInstance(u)}),e.YNc(14,Q,2,0,"ng-template",6),e.YNc(15,U,2,0,"ng-template",6),e.YNc(16,$,2,0,"ng-template",6),e.qZA()()),2&n&&(e.Q6J("translucent",!0),e.xp6(3),e.hij(" ",e.lcZ(4,4,"bus.title")," "),e.xp6(2),e.Q6J("fullscreen",!0),e.xp6(4),e.Oqu(e.lcZ(10,6,"bus.title")))},dependencies:[a.W2,a.Gu,a.nJ,a.Wo,a.wd,a.sr,p.nF,p.YC,J,l.X$],styles:["app-bus-card[_ngcontent-%COMP%]{width:100%}swiper[_ngcontent-%COMP%]{width:100%}.slide-content[_ngcontent-%COMP%]{width:100%}"]}),t})()}];let R=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[_.Bz.forChild(F),_.Bz]}),t})();var z=r(6472);let G=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[a.Pc,m.ez,C.u5,N.e,R,l.aw,p.kz,z.H]}),t})()}}]);