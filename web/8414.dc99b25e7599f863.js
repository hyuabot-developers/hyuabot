"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8414],{8414:(M,d,a)=>{a.r(d),a.d(d,{BusTimetableModule:()=>B});var n=a(5056),g=a(6895),T=a(4006),r=a(6753),b=a(7885),m=a(4964),e=a(6353),p=a(9989),y=a(4471);const f=function(t,o){return{hour:t,minute:o}};function v(t,o){if(1&t&&(e.TgZ(0,"ion-item",11)(1,"div",12)(2,"ion-text"),e._uU(3),e.ALo(4,"translate"),e.qZA()()()),2&t){const s=o.$implicit,i=o.index,u=e.oxw();e.Q6J("lines",i===u.busTimetableItems.length-1?"none":"inset"),e.xp6(3),e.Oqu(e.xi3(4,2,"bus.timetable.item.all",e.WLB(5,f,s.departureTime.split(":")[0],s.departureTime.split(":")[1])))}}const h=function(t){return{routeName:t}},w=m.Ps`
    query GetPeriod($currentDate: String!) {
      shuttle {
        weekday (date: $currentDate),
      }
    }
  `,S=m.Ps`
  query GetBusTimetable($stopName: String!, $routeName: String!) {
    bus(routePair: [
      {stopName: $stopName, routeName: $routeName}
    ]) {
      timetable {
        weekday,
        departureTime
      }
    }
  }`,k=[{path:"",component:(()=>{class t{constructor(s,i,u,l,c,P){this.route=s,this.apollo=i,this.toastController=u,this.translateService=l,this.busTimetableService=c,this.loadingService=P,this.busTimetableItems=[],this.now=new Date}ngOnInit(){const s=new Date;this.route.queryParams.subscribe(i=>{this.routeName=i.route,this.stop=i.stop}),this.busDateSubscription=this.apollo.watchQuery({query:w,variables:{currentDate:`${s.getFullYear()}-${s.getMonth()+1}-${s.getDate()}`}}).valueChanges.subscribe(({data:i})=>{"weekdays"===i.shuttle.weekday?this.busTimetableService.weekday.next("weekdays"):6===s.getDay()?this.busTimetableService.weekday.next("saturday"):(0===s.getDay()||"weekends"===i.shuttle.weekday)&&this.busTimetableService.weekday.next("sunday"),this.busDateSubscription?.unsubscribe(),this.busTimetableQueryRef=this.apollo.watchQuery({query:S,pollInterval:6e4,variables:{stopName:this.getStopName(),routeName:this.routeName}}),this.busTimetableSubscription=this.busTimetableQueryRef.valueChanges.subscribe(({data:l,loading:c})=>{this.busTimetableService.setLoading(c),l.bus.length>0&&this.busTimetableService.setBusTimetable(l.bus[0].timetable),this.now=new Date})}),this.busTimetableService.loading.subscribe(i=>{i&&this.loadingService.present("shuttle.loading","shuttle.loading").then(()=>{this.busTimetableService.loading.subscribe(u=>{u||this.loadingService.dismiss("shuttle.loading").then()})})}),this.busTimetableService.weekday.subscribe(i=>{this.weekday=i,this.busTimetableItems=this.busTimetableService.busTimetable.value.filter(u=>u.weekday===i)}),this.busTimetableService.busTimetable.subscribe(i=>{this.busTimetableItems=i.filter(u=>u.weekday===this.busTimetableService.weekday.value)})}ngOnDestroy(){this.busDateSubscription?.unsubscribe(),this.busTimetableSubscription?.unsubscribe()}changeWeekday(){"weekdays"===this.busTimetableService.weekday.value?this.busTimetableService.weekday.next("saturday"):"saturday"===this.busTimetableService.weekday.value?this.busTimetableService.weekday.next("sunday"):"sunday"===this.busTimetableService.weekday.value&&this.busTimetableService.weekday.next("weekdays")}getStopName(){switch(this.stop){case"guestHouse":return"\ud55c\uc591\ub300\uac8c\uc2a4\ud2b8\ud558\uc6b0\uc2a4";case"mainGate":return"\ud55c\uc591\ub300\uc815\ubb38"}}}return t.\u0275fac=function(s){return new(s||t)(e.Y36(b.gz),e.Y36(m._M),e.Y36(n.yF),e.Y36(r.sK),e.Y36(p.W),e.Y36(y.b))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-bus-timetable"]],decls:20,vars:21,consts:[[3,"translucent"],["slot","start"],["defaultHref","/bus"],[3,"fullscreen"],["collapse","condense"],["size","large"],["lines","inset"],[3,"lines",4,"ngFor","ngForOf"],["vertical","bottom","horizontal","end","slot","fixed",2,"margin-bottom","10px","margin-right","10px"],[3,"click"],["name","swap-horizontal-outline"],[3,"lines"],[1,"container"]],template:function(s,i){1&s&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e._UZ(3,"ion-back-button",2),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5),e.ALo(6,"translate"),e.ALo(7,"translate"),e.qZA()()(),e.TgZ(8,"ion-content",3)(9,"ion-header",4)(10,"ion-toolbar")(11,"ion-title",5),e._uU(12),e.ALo(13,"translate"),e.ALo(14,"translate"),e.qZA()()(),e.TgZ(15,"ion-list",6),e.YNc(16,v,5,8,"ion-item",7),e.qZA(),e.TgZ(17,"ion-fab",8)(18,"ion-fab-button",9),e.NdJ("click",function(){return i.changeWeekday()}),e._UZ(19,"ion-icon",10),e.qZA()()()),2&s&&(e.Q6J("translucent",!0),e.xp6(5),e.AsE(" ",e.xi3(6,7,"bus.timetable.title",e.VKq(17,h,i.routeName))," (",e.lcZ(7,10,"bus.timetable."+i.weekday),") "),e.xp6(3),e.Q6J("fullscreen",!0),e.xp6(4),e.AsE(" ",e.xi3(13,12,"bus.timetable.title",e.VKq(19,h,i.routeName))," (",e.lcZ(14,15,"bus.timetable."+i.weekday),") "),e.xp6(4),e.Q6J("ngForOf",i.busTimetableItems))},dependencies:[n.oU,n.Sm,n.W2,n.IJ,n.W4,n.Gu,n.gu,n.Ie,n.q_,n.yW,n.wd,n.sr,n.cs,g.sg,r.X$],styles:["ion-list[_ngcontent-%COMP%]{padding:20px;margin-bottom:60px;--ion-item-background: var(--ion-background-color)}ion-item[_ngcontent-%COMP%]{--padding-start: 0;--padding-end: 0;--inner-padding-end: 0}ion-item[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;flex-direction:row}ion-item[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .realtime[_ngcontent-%COMP%]{font-weight:700}ion-item[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{font-size:medium;text-align:end;margin-top:5px;margin-bottom:5px}"]}),t})()}];let x=(()=>{class t{}return t.\u0275fac=function(s){return new(s||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[b.Bz.forChild(k),b.Bz]}),t})(),B=(()=>{class t{}return t.\u0275fac=function(s){return new(s||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[n.Pc,g.ez,T.u5,r.aw,x]}),t})()}}]);